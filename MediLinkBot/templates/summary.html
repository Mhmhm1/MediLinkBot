<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Session Summary - MediLink</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="container">
        <header class="text-center py-4">
            <h1 class="logo">MediLink</h1>
            <p class="subtitle">Consultation Summary</p>
        </header>

        <div class="chat-container">
            <div class="chat-message bot-message">
                <div class="message-icon">ðŸ¤–</div>
                <div class="message-content">
                    <p class="mb-0">Thank you, {{ user_info.name }}! Here's a complete summary of your consultation:</p>
                </div>
            </div>

            <div class="card summary-card mt-4">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-person-circle me-2" viewBox="0 0 16 16">
                            <path d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0"/>
                            <path fill-rule="evenodd" d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8m8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1"/>
                        </svg>
                        Patient Information
                    </h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-4 mb-2">
                            <strong>Name:</strong> {{ user_info.name }}
                        </div>
                        <div class="col-md-4 mb-2">
                            <strong>Age:</strong> {{ user_info.age }} years
                        </div>
                        <div class="col-md-4 mb-2">
                            <strong>Location:</strong> {{ user_info.location }}
                        </div>
                    </div>
                    <div class="mt-2">
                        <strong>Date:</strong> {{ timestamp }}
                    </div>
                </div>
            </div>

            <div class="card summary-card mt-3">
                <div class="card-header bg-warning text-dark">
                    <h5 class="mb-0">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-thermometer-half me-2" viewBox="0 0 16 16">
                            <path d="M9.5 12.5a1.5 1.5 0 1 1-2-1.415V6.5a.5.5 0 0 1 1 0v4.585a1.5 1.5 0 0 1 1 1.415"/>
                            <path d="M5.5 2.5a2.5 2.5 0 0 1 5 0v7.55a3.5 3.5 0 1 1-5 0zM8 1a1.5 1.5 0 0 0-1.5 1.5v7.987l-.167.15a2.5 2.5 0 1 0 3.333 0l-.166-.15V2.5A1.5 1.5 0 0 0 8 1"/>
                        </svg>
                        Reported Symptoms
                    </h5>
                </div>
                <div class="card-body">
                    <ul class="symptom-summary-list">
                        {% for symptom in symptoms %}
                        <li>{{ symptom|title }}</li>
                        {% endfor %}
                    </ul>
                </div>
            </div>

            <div class="card summary-card mt-3">
                <div class="card-header bg-danger text-white">
                    <h5 class="mb-0">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-clipboard2-pulse me-2" viewBox="0 0 16 16">
                            <path d="M9.5 0a.5.5 0 0 1 .5.5.5.5 0 0 0 .5.5.5.5 0 0 1 .5.5V2a.5.5 0 0 1-.5.5h-5A.5.5 0 0 1 5 2v-.5a.5.5 0 0 1 .5-.5.5.5 0 0 0 .5-.5.5.5 0 0 1 .5-.5z"/>
                            <path d="M3 2.5a.5.5 0 0 1 .5-.5H4a.5.5 0 0 0 0-1h-.5A1.5 1.5 0 0 0 2 2.5v12A1.5 1.5 0 0 0 3.5 16h9a1.5 1.5 0 0 0 1.5-1.5v-12A1.5 1.5 0 0 0 12.5 1H12a.5.5 0 0 0 0 1h.5a.5.5 0 0 1 .5.5v12a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5z"/>
                            <path d="M9.979 5.356a.5.5 0 0 0-.968.04L7.92 10.49l-.94-3.135a.5.5 0 0 0-.926-.08L4.69 10H4.5a.5.5 0 0 0 0 1H5a.5.5 0 0 0 .447-.276l.936-1.873 1.138 3.793a.5.5 0 0 0 .968-.04L9.58 7.51l.94 3.135A.5.5 0 0 0 11 11h.5a.5.5 0 0 0 0-1h-.128z"/>
                        </svg>
                        Primary Diagnosis
                    </h5>
                </div>
                <div class="card-body">
                    <h4 class="text-danger">{{ user_info.selected_disease }}</h4>
                    <p class="mb-0"><small class="text-muted">Based on symptom analysis and matching</small></p>
                </div>
            </div>

            <div class="card summary-card mt-3">
                <div class="card-header bg-success text-white">
                    <h5 class="mb-0">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-capsule me-2" viewBox="0 0 16 16">
                            <path d="M1.828 8.9 8.9 1.827a4 4 0 1 1 5.657 5.657l-7.07 7.071A4 4 0 1 1 1.827 8.9Zm9.128.771 2.893-2.893a3 3 0 1 0-4.243-4.242L6.713 5.429z"/>
                        </svg>
                        Recommended Medications with Dosage
                    </h5>
                </div>
                <div class="card-body">
                    {% for med in user_info.medications %}
                    <div class="medication-details">
                        <div class="medication-name">ðŸ’Š {{ med.name }}</div>
                        <div class="medication-dosage"><strong>Dosage:</strong> {{ med.dosage }}</div>
                        <div class="medication-side-effects">
                            <strong>Common Side Effects:</strong> 
                            {% if med.side_effects %}
                                {{ med.side_effects|join(', ') }}
                            {% else %}
                                Consult doctor
                            {% endif %}
                        </div>
                    </div>
                    {% endfor %}
                    <div class="alert alert-warning mt-3 mb-0">
                        <small><strong>Note:</strong> Please consult with your healthcare provider before taking any medication. Dosages may vary based on your specific condition.</small>
                    </div>
                </div>
            </div>

            <div class="card summary-card mt-3">
                <div class="card-header bg-info text-white">
                    <h5 class="mb-0">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-person-badge me-2" viewBox="0 0 16 16">
                            <path d="M6.5 2a.5.5 0 0 0 0 1h3a.5.5 0 0 0 0-1zM11 8a3 3 0 1 1-6 0 3 3 0 0 1 6 0"/>
                            <path d="M4.5 0A2.5 2.5 0 0 0 2 2.5V14a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V2.5A2.5 2.5 0 0 0 11.5 0zM3 2.5A1.5 1.5 0 0 1 4.5 1h7A1.5 1.5 0 0 1 13 2.5v10.795a4.2 4.2 0 0 0-.776-.492C11.392 12.387 10.063 12 8 12s-3.392.387-4.224.803a4.2 4.2 0 0 0-.776.492z"/>
                        </svg>
                        Selected Doctor
                    </h5>
                </div>
                <div class="card-body">
                    <h4 class="text-info">{{ user_info.selected_doctor }}</h4>
                    <p class="mb-1"><strong>Specialty:</strong> {{ user_info.specialist }}</p>
                    <p class="mb-0"><small class="text-muted">Your appointment has been recommended with this specialist for {{ user_info.selected_disease }}.</small></p>
                </div>
            </div>

            <div class="alert alert-primary mt-4">
                <h6>Next Steps:</h6>
                <ul class="mb-0">
                    <li>Continue your conversation with {{ user_info.selected_doctor }} in MediLink.</li>
                    <li>Share any new or worsening symptoms in the chat.</li>
                    <li>If you decide to book, bring this summary to your appointment.</li>
                    <li>Confirm any medication choices and doses with the doctor.</li>
                </ul>
            </div>

            <div class="d-flex justify-content-center mt-4 gap-3">
                <button onclick="window.print()" class="btn btn-outline-primary">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-printer me-2" viewBox="0 0 16 16">
                        <path d="M2.5 8a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1"/>
                        <path d="M5 1a2 2 0 0 0-2 2v2H2a2 2 0 0 0-2 2v3a2 2 0 0 0 2 2h1v1a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-1h1a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-1V3a2 2 0 0 0-2-2zM4 3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v2H4zm1 5a2 2 0 0 0-2 2v1H2a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v-1a2 2 0 0 0-2-2zm7 2v3a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1"/>
                    </svg>
                    Print Summary
                </button>
                <a href="{{ url_for('restart') }}" class="btn btn-primary">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-clockwise me-2" viewBox="0 0 16 16">
                        <path fill-rule="evenodd" d="M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2z"/>
                        <path d="M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466"/>
                    </svg>
                    Start New Consultation
                </a>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
